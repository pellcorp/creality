[gcode_macro _GUPPYSCREEN_EXTRUDE]
gcode:
  {% set EXTRUDER_TEMP = params.EXTRUDER_TEMP|int %}
  {% set EXTRUDE_LEN = params.EXTRUDE_LEN|int %}
  {% set SPEED = params.SPEED|int %}
  {% set target_nozzle_temp = printer[printer.toolhead.extruder].target %}
  {% if target_nozzle_temp < EXTRUDER_TEMP %}
    M109 S{EXTRUDER_TEMP}
  {% endif %}
  M83
  G1 E{EXTRUDE_LEN} F{SPEED}
  M400

  {% if target_nozzle_temp != EXTRUDER_TEMP %}
    M109 S{target_nozzle_temp}
  {% endif %}


[gcode_macro _GUPPYSCREEN_RETRACT]
gcode:
  {% set EXTRUDER_TEMP = params.EXTRUDER_TEMP|int %}
  {% set EXTRUDE_LEN = params.EXTRUDE_LEN|int %}
  {% set SPEED = params.SPEED|int %}
  {% set target_nozzle_temp = printer[printer.toolhead.extruder].target %}
  {% if target_nozzle_temp < EXTRUDER_TEMP %}
    M109 S{EXTRUDER_TEMP}
  {% endif %}
  M83
  G1 E-{EXTRUDE_LEN} F{SPEED}
  M400
  {% if target_nozzle_temp != EXTRUDER_TEMP %}
    M109 S{target_nozzle_temp}
  {% endif %}


[gcode_macro _GUPPYSCREEN_LOAD]
gcode:
  {% set EXTRUDER_TEMP = params.EXTRUDER_TEMP|int %}
  {% set target_nozzle_temp = printer[printer.toolhead.extruder].target %}
  {% if target_nozzle_temp < EXTRUDER_TEMP %}
    M109 S{EXTRUDER_TEMP}
  {% endif %}
  M83
  G1 E50 F180
  M400
  {% if target_nozzle_temp != EXTRUDER_TEMP %}
    M109 S{target_nozzle_temp}
  {% endif %}


[gcode_macro _GUPPYSCREEN_UNLOAD]
gcode:
  {% set EXTRUDER_TEMP = params.EXTRUDER_TEMP|int %}

  {% set target_nozzle_temp = printer[printer.toolhead.extruder].target %}
  {% if target_nozzle_temp < EXTRUDER_TEMP %}
    M109 S{EXTRUDER_TEMP}
  {% endif %}
  M83
  G1 E20 F180
  G1 E-60 F180
  G1 E-50 F2000
  M400
  {% if target_nozzle_temp != EXTRUDER_TEMP %}
    M109 S{target_nozzle_temp}
  {% endif %}


[gcode_macro EXCITATE_AXIS_AT_FREQUENCY]
gcode:
  RESPOND TYPE=error MSG='Not supported in stock mode'


[gcode_macro BELTS_SHAPER_CALIBRATION]
gcode:
  RESPOND TYPE=error MSG='Not supported in stock mode'
